<style>
  .booking-container {
    width: 80%;
    max-width: 800px;
    background-color: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  }

  .booking {
    margin-bottom: 15px;
    border-bottom: 1px solid #ddd;
    padding-bottom: 10px;
  }

  .booking button {
    background-color: #000;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    margin-right: 10px;
  }

  .booking button:hover {
    background-color: #333;
  }

  .modify-dates {
    display: none;
    margin-top: 10px;
  }

  .back-button {
    margin-top: 20px;
    background-color: #6200ea;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1rem;
  }

  .back-button:hover {
    background-color: #4b00b1;
  }

  .slider-overlay {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    pointer-events: auto;
    background-color: #000000c1;
    transition: 0.3s;
  }
  .slider {
    transition: 0.3s;
    position: relative;
    top: 0%;
    padding: 1rem;
    height: 100%;
  }
  .down {
    background-color: #00000000;
    pointer-events: none;
  }
  .down .slider {
    top: 100%;
  }

  .card {
    background-color: white;
    max-width: 600px;
    width: 100%;
    border-radius: 1rem;
    overflow-y: scroll;
    height: 100%;
    padding: 1rem;
  }

  .card h1 {
    margin-top: 1rem;
    margin-bottom: 0.5rem;
  }
  .card h2 {
    margin-top: 1rem;
    margin-bottom: 0.5rem;
  }

  .room-display {
    display: flex;
    -webkit-box-shadow: -1px 10px 20px 0px rgba(0, 0, 0, 0.12);
    -moz-box-shadow: -1px 10px 20px 0px rgba(0, 0, 0, 0.12);
    box-shadow: -1px 10px 20px 0px rgba(0, 0, 0, 0.12);
    width: 100%;
    border-radius: 1rem;
    height: 10rem;
    min-height: 10rem;
    overflow: hidden;
    border: 2px black solid;
  }
    .room-display img{
        width: 50%;
    } 
  .room-display-details{
    flex-grow: 1;
    padding: 1rem;
  }
  .room-display-details h3{
    margin-bottom: 1rem;
  }

  .card select{
    padding: 0.5rem;
    margin: 1rem;
  }
</style>

<div class="column-stack">
  <h1>Your Bookings</h1>
  <button class="buttons" onclick="newBookingButtonCreated()">
    Book a room
  </button>
  <div class="booking-container" id="booking-container"></div>
  </div>
</div>

<div class="slider-overlay">
  <div class="slider column-stack">
    <div class="card column-stack">
      <button class="buttons" id="backButon" onclick="toggleDown()">
        Back
      </button>
      <h1>Create a booking</h1>
      <!-- room selector -->
      <h2>Selected Room</h2>
      <div class="room-display">
        <img src="assets/meetingRoom.jpg" alt="" />
        <div class="room-display-details">
          <h3 id="roomName">room name</h3>
          <div><strong>Capacity</strong>: <span id="capacity">300</span></div>
          <div>
            <strong>Rent per hour</strong>: $ <span id="costPerHour">300</span>
          </div>
        </div>
      </div>
      <select name="" id="roomSelector">
        <option value="d">room name</option>
        <option value="d">room name</option>
        <option value="d">room name</option>
        <option value="d">room name</option>
      </select>

      <!-- date selector -->
      <h2>Set a date</h2>
      <input type="date" id="birthday" name="birthday" />
      <!-- time selector -->
      <h2>Set a time</h2>
      <p>Every booking is an hour</p>
      <select name="" id="timeSelector">
        <option value="d">room name</option>
        <option value="d">room name</option>
        <option value="d">room name</option>
        <option value="d">room name</option>
      </select>
      <!-- payment -->
      <h2>Payment</h2>
    <div class="payment-container column-stack">
        <input type="text" placeholder="Card Number">
        <input type="text" placeholder="MM/YY">
        <input type="text" placeholder="CVC">
        <input type="text" placeholder="Promo Code (Optional)">
    </div>
      <!-- Pay and save -->
      <p>Every booking edit is a new payment</p>
      <button class="buttons">Make Payment and Create</button>
    </div>
  </div>
</div>

<script>
  // event callbacks
  function toggleUp() {
    document.querySelector(".slider-overlay").classList.remove("down");
  }
  function toggleDown() {
    document.querySelector(".slider-overlay").classList.add("down");
  }
  function newBookingButtonCreated() {
    toggleUp();
  }

  window.onload = function () {
    displayBookings();
  };

  function displayBookings() {
    const bookings = JSON.parse(localStorage.getItem("userBookings")) || [];
    const bookingContainer = document.getElementById("booking-container");

    if (bookings.length === 0) {
      bookingContainer.innerHTML = "<p>No bookings found.</p>";
      return;
    }

    bookingContainer.innerHTML = "";

    bookings.forEach((booking, index) => {
      const bookingDiv = document.createElement("div");
      bookingDiv.className = "booking";
      bookingDiv.innerHTML = `
                    <p><strong>Room:</strong> ${booking.roomName}</p>
                    <p><strong>From:</strong> <span id="from-date-${index}">${booking.from}</span></p>
                    <p><strong>To:</strong> <span id="to-date-${index}">${booking.to}</span></p>
                    <button onclick="showModifyDates(${index})">Modify Dates</button>
                    <button onclick="cancelBooking(${index})">Cancel</button>

                    <div class="modify-dates" id="modify-dates-${index}">
                        <label>From: <input type="date" id="new-from-date-${index}"></label><br><br>
                        <label>To: <input type="date" id="new-to-date-${index}"></label><br><br>
                        <button onclick="saveModifiedDates(${index})">Save</button>
                    </div>
                `;
      bookingContainer.appendChild(bookingDiv);
    });
  }

  function showModifyDates(index) {
    const modifyDiv = document.getElementById(`modify-dates-${index}`);
    modifyDiv.style.display =
      modifyDiv.style.display === "none" ? "block" : "none";
  }

  function saveModifiedDates(index) {
    const newFromDate = document.getElementById(`new-from-date-${index}`).value;
    const newToDate = document.getElementById(`new-to-date-${index}`).value;

    if (
      !newFromDate ||
      !newToDate ||
      new Date(newFromDate) >= new Date(newToDate)
    ) {
      alert("Please enter valid dates.");
      return;
    }

    const bookings = JSON.parse(localStorage.getItem("userBookings"));
    bookings[index].from = newFromDate;
    bookings[index].to = newToDate;
    localStorage.setItem("userBookings", JSON.stringify(bookings));

    displayBookings(); // Refresh the bookings display
  }

  function cancelBooking(index) {
    const bookings = JSON.parse(localStorage.getItem("userBookings"));
    bookings.splice(index, 1);
    localStorage.setItem("userBookings", JSON.stringify(bookings));
    displayBookings(); // Refresh the bookings display
  }

  function goToHome() {
    window.location.href = "home.html";
  }
</script>
